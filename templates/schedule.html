{% extends "base.html" %}

{% block content %}
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js'></script>

<div class="row">
    <div class="col-md-9 mb-4">
        <div class="card shadow-sm">
            <div class="card-body p-4">
                <div id='calendar'></div>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        {% if current_user.is_authenticated and current_user.is_admin %}
        <div class="card bg-light shadow-sm mb-3">
            <div class="card-header fw-bold bg-white">
                â• ì¼ì • ì¶”ê°€ (ê´€ë¦¬ì)
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label class="form-label small fw-bold">ì¼ì • ì´ë¦„</label>
                        <input type="text" class="form-control" name="title" placeholder="ì˜ˆ: ê²¨ìš¸ë°©í•™ í•©ì£¼" required>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label small fw-bold">ì‹œì‘ ë‚ ì§œ</label>
                        <input type="date" class="form-control" name="start_date" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">ì¢…ë£Œ ë‚ ì§œ</label>
                        <input type="date" class="form-control" name="end_date">
                        <div class="form-text text-muted" style="font-size: 0.75rem;">
                            í•˜ë£¨ ì¼ì •ì´ë¼ë©´ ë¹„ì›Œë‘ê±°ë‚˜<br>ì‹œì‘ì¼ê³¼ ë˜‘ê°™ì´ ì„¤ì •í•˜ì„¸ìš”.
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100">ì¶”ê°€í•˜ê¸°</button>
                </form>
            </div>
        </div>
        <div class="alert alert-info small border-0">
            ğŸ’¡ <b>íŒ:</b><br>
            ì œëª©ì— 'ê³µì—°'ì´ ë“¤ì–´ê°€ë©´ <span class="text-danger fw-bold">ë¹¨ê°„ìƒ‰</span>,<br>
            ê·¸ ì™¸ì—ëŠ” <span class="text-primary fw-bold">íŒŒë€ìƒ‰</span>ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.
        </div>
        {% else %}
        <div class="card bg-light border-0">
            <div class="card-body text-center text-muted">
                <p class="mb-0">ì„±ê· ê´€ëŒ€ ëª¨ì—¬ë½<br>ê³µì‹ ì¼ì •í‘œì…ë‹ˆë‹¤.</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        
        // Flask(app.py)ì—ì„œ ë„˜ê²¨ì¤€ ë°ì´í„°ë¥¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ê°€ì ¸ì˜´
        // | tojson í•„í„°ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤!
        var myEvents = {{ events_data | tojson }};

        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth', // ì›”ë³„ ë³´ê¸°
            locale: 'ko',               // í•œêµ­ì–´ ì„¤ì •
            height: 'auto',             // ë†’ì´ ìë™ ë§ì¶¤
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,listMonth'
            },
            events: myEvents,           // ë°ì´í„° ì£¼ì…
            eventDisplay: 'block',      // ì¼ì •ì„ ìƒ‰ê¹” ë  í˜•íƒœë¡œ í‘œì‹œ
            dayMaxEvents: true          // ì¼ì •ì´ ë„ˆë¬´ ë§ìœ¼ë©´ '+more'ë¡œ í‘œì‹œ
        });

        calendar.render();
    });
</script>

<style>
    /* ìº˜ë¦°ë” ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ */
    /* ì¼ì • ë¸”ë¡ì˜ ê¸€ì”¨ ìŠ¤íƒ€ì¼ */
    .fc-event { 
        cursor: pointer; 
        text-decoration: none; 
        font-size: 0.9rem;
    }
    .fc-event-title { font-weight: 500; }
    
    /* í† ìš”ì¼ ë‚ ì§œ íŒŒë€ìƒ‰ */
    .fc-day-sat a { color: #0d6efd; text-decoration: none; }
    /* ì¼ìš”ì¼ ë‚ ì§œ ë¹¨ê°„ìƒ‰ */
    .fc-day-sun a { color: #dc3545; text-decoration: none; }
    
    /* ì˜¤ëŠ˜ ë‚ ì§œ ë°°ê²½ ê°•ì¡° */
    .fc-day-today { background-color: #f8f9fa !important; }
</style>
{% endblock %}